<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>NC Depression Hotspots Dashboard (D3)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    /*Style html elements added using the JS file*/
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      color: #222;
      background: #fff;
    }

    #main-content {
      display: flex;
      height: 100vh;
      overflow: hidden;
    }

    /*The space that holds the map, title, etc.*/
    #map-container {
      flex: 1 1 auto;
      display: flex;
      flex-direction: column;
      border-right: 1px solid #e6e6e6;
      min-width: 480px;
    }

    #map-title {
      margin: 0;
      padding: 14px 18px;
      font-size: 18px;
      font-weight: 600;
      text-align: center;
      border-bottom: 1px solid #eee;
      background: #fff;
    }

    /*Regional selection buttons styling*/
    #region-controls {
      padding: 8px 16px;
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      align-items: center;
      background: #fff;
    }


    #map {
      width: 100%;
      flex: 1 1 auto;
      min-height: 420px;
      height: auto;
      display: block;
      background: #fafafa;
    }

    /* Stye county details panel and add scrolling feature for users to see all of the data*/
    #map-details {
      padding: 12px 16px;
      border-top: 1px solid #eee;
      background: #fff;
      font-size: 13px;
      height: 240px;
      margin-top: -50px; 
      box-shadow: 0 -6px 12px rgba(0,0,0,0.03);
      position: relative;
      z-index: 2;
      overflow-y: auto;
      padding-right: 8px;
    }

    /*Style the scatterplots*/
    #scatter-wrapper {
      padding: 12px 16px;
      border-top: 1px solid #eee;
      background: #fafafa;
    }

    .scatter-row {
      display: flex;
      gap: 12px;
      align-items: stretch;
    }

    .scatter-panel {
      flex: 1 1 0;
      background: white;
      padding: 8px;
      border: 1px solid #eee;
      border-radius: 4px;
    }

    .scatter-panel svg {
      width: 100%;
      height: 300px;
      display: block;
    }

    /* Formula tab styling */
    #sidebar {
      width: 480px; 
      background: #fff;
      overflow: auto;
    }

    #needs-index-controls { padding: 16px; }

    /*Styles hover tooltip*/
    .tooltip {
      position: absolute;
      pointer-events: none;
      background: white;
      border: 1px solid #ccc;
      padding: 6px 8px;
      border-radius: 4px;
      font-size: 12px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.12);
      opacity: 0;
      transition: opacity 0.08s ease;
      max-width: 260px;
    }

  /* Sidebar styling (formula and graphs tab) */
  .sidebar-tab { font-weight: 700; color: #000; font-size:14px; background: transparent; }
  .sidebar-tab.active { background:#3182bd; color:white; }
  .scatter-panel { background:white; padding:8px; border:1px solid #eee; border-radius:4px; }
  .scatter-panel svg { width:100%; height:300px; display:block; }
    @media (max-width: 900px) {
      .scatter-row { flex-direction: column; }
      #map { height: 360px; }
      #sidebar { width: 100%; height: 320px; }
      #main-content { flex-direction: column; }
    }
  </style>
</head>
<body>
  <!--
    Main layout arranging map features on the left and sidebar on the right
  -->
  <div id="main-content">
    <div id="map-container">
      <!-- Map title -->
  <h2 id="map-title">NC Depression Hotspots</h2>
  <!-- Region quick-select buttons -->
  <div id="region-controls"></div>
      <!-- Map legen scale -->
      <div id="map-legend" style="padding:8px 16px; background:#fff; border-bottom:1px solid #eee; display:flex; align-items:center;">
      </div>

  <!-- Map container and tooltip container shown on hover -->
      <svg id="map"></svg>
      <div id="tooltip" class="tooltip"></div>

      <!-- County details panel (under the map) -->
      <div id="map-details">
        <h3 id="map-county-title" style="margin:0 0 6px 0; font-size:15px;">County Details</h3>
        <div id="map-county-details">Click a county on the map to see its depression rate and demographics.</div>
      </div>
    </div>

    <div id="sidebar">
      <!-- Tabs to switch between Formula and Graphs-->
      <div id="sidebar-tabs" style="display:flex; gap:8px; padding:12px; border-bottom:1px solid #eee;">
        <button id="tab-formula" class="sidebar-tab" style="flex:1; padding:8px; border:1px solid #e0e0e0; cursor:pointer;">Formula</button>
        <button id="tab-graphs" class="sidebar-tab" style="flex:1; padding:8px; border:1px solid #e0e0e0; cursor:pointer;">Graphs</button>
      </div>

      <!-- Formula panel -->
      <div id="panel-formula">
        <div id="needs-index-controls">
          <div style="display:flex; align-items:center;">
            <h3 style="margin:0;">Needs Index (formula)</h3>
          </div>
          <div id="needs-index-content" style="margin-top:8px;">
            <p style="margin:0 0 8px 0; font-size:12px; color:#555;">Choose variables to include and adjust their relative weights. Weights are normalized automatically.</p>
            <div style="display:flex; flex-direction:column; gap:8px;">
              <label><input type="checkbox" id="var-income" checked> Median income (higher = less need)</label>
              <label><input type="checkbox" id="var-education" checked> % Bachelor+ (higher = less need)</label>
              <label><input type="checkbox" id="var-depression" checked> Depression (age-adjusted) (higher = more need)</label>
              <label><input type="checkbox" id="var-poverty" checked> Poverty rate (higher = more need)</label>

              <div style="display:flex; gap:8px; align-items:center;">
                <div style="flex:1">
                  <label style="font-size:12px;">Income weight: <input id="w-income" type="range" min="0" max="100" value="25"></label>
                </div>
                <div style="flex:1">
                  <label style="font-size:12px;">Education weight: <input id="w-education" type="range" min="0" max="100" value="25"></label>
                </div>
              </div>
              <div style="display:flex; gap:8px; align-items:center;">
                <div style="flex:1">
                  <label style="font-size:12px;">Depression weight: <input id="w-depression" type="range" min="0" max="100" value="25"></label>
                </div>
                <div style="flex:1">
                  <label style="font-size:12px;">Poverty weight: <input id="w-poverty" type="range" min="0" max="100" value="25"></label>
                </div>
              </div>

              <div style="display:flex; gap:8px;">
                <button id="apply-needs" type="button" style="padding:6px 10px; border:1px solid #ccc; background:#3182bd; color:white; cursor:pointer;">Apply Needs Index</button>
                <button id="reset-needs" type="button" style="padding:6px 10px; border:1px solid #ccc; background:white; cursor:pointer;">Reset</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Graphs panel with scatterplots stacked vertically and scrollable -->
      <div id="panel-graphs" style="display:none; padding:12px;">
        <div id="selection-mode-controls" style="display:flex; gap:8px; align-items:center; margin-bottom:8px;">
          <button id="mode-individual" type="button" style="padding:6px 10px; border:1px solid #ccc; background:#3182bd; color:white; cursor:pointer;">Individual select</button>
          <button id="mode-cluster" type="button" style="padding:6px 10px; border:1px solid #ccc; background:white; cursor:pointer;">Select clusters</button>
        </div>
        <div id="graphs-scroll" style="max-height: calc(100vh - 160px); overflow-y: auto; display:flex; flex-direction:column; gap:12px;">
          <div class="scatter-panel" id="scatter-income">
            <svg id="scatter-income-svg"></svg>
          </div>
          <div class="scatter-panel" id="scatter-poverty">
            <svg id="scatter-poverty-svg"></svg>
          </div>
          <div class="scatter-panel" id="scatter-education">
            <svg id="scatter-education-svg"></svg>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Connect D3 and JS to the page to add functionality and draw visualizations after page loads -->
  <script src="https://cdn.jsdelivr.net/npm/d3@7/dist/d3.min.js"></script>
  <script src="js/app.js"></script>
</body>
</html>
